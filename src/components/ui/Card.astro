---
import type { ProjectProps } from "@/data/projects";

import Pill from "./Pill.astro";
import CustomButton from "./CustomButton.astro";
import PreviewIcon from "../../icons/PreviewIcon.astro";
import GithubOutlineIcon from "../../icons/GithubOutlineIcon.astro";
import MeshButton from "./MeshButton.astro";

const {
  imageSrc,
  imageAlt,
  projectTitle,
  projectDescription,
  previewLink,
  githubLink,
  techs = [],
} = Astro.props as ProjectProps;
---

<div
  class="squircle fade-up-card relative flex flex-col min-h-[38rem] overflow-hidden rounded-4xl border-1 border-white/20"
>
  <div class="flex flex-col h-full w-full">
    <div class="relative w-full h-1/2 p-6">
      <!-- Imagen de fondo -->
      <picture class="absolute inset-0 -z-[2]">
        <img
          src={imageSrc}
          alt={imageAlt ?? "Project Image"}
          class="w-full h-full object-cover"
          loading="lazy"
          decoding="async"
        />
      </picture>

      {
        previewLink && (
          <MeshButton
            text="Preview"
            Icon={PreviewIcon}
            textSize="text-base"
            textColor="text-slate-800"
            href={previewLink}
          />
        )
      }

      {
        githubLink && (
          <CustomButton
            text="Repository"
            Icon={GithubOutlineIcon}
            textSize="text-base"
            textColor="text-white"
            bgColor="bg-zinc-900/60"
            href={githubLink}
            extraClass="font-medium rounded-xl"
          />
        )
      }
    </div>

    <div class="relative flex flex-col gap-2 justify-start w-full h-1/2 p-6">

      <picture class="absolute inset-0 -z-[2]">
        <img
          src={imageSrc}
          alt={imageAlt ?? "Project Image"}
          class="w-full h-full object-cover"
          loading="lazy"
          decoding="async"
        />
      </picture>

      <div class="absolute inset-0 -z-[1] backdrop-blur-2xl"></div>

      <div class="flex flex-col">
        <div class="flex flex-wrap gap-x-1.5 w-full">
          {techs.map((tech) => <Pill pillText={tech} key={tech} />)}
        </div>

        <span class="text-2xl font-semibold line-clamp-2 text-white">
          {projectTitle}
        </span>

        <p class="text-sm text-pretty line-clamp-7 text-white/90">
          {projectDescription}
        </p>
      </div>
    </div>
  </div>
</div>

<style>
  .fade-up-card {
    animation: slideIn 0.6s ease-out backwards;
    animation-timeline: view();
    animation-range: entry 20% cover 40%;
  }

  @supports (corner-shape: squircle) {
    .squircle {
      border-radius: 4.5rem;
      corner-shape: squircle;
    }
  }
</style>
